import{_ as h,f as b,g as y,o as u,c,a as t,m as w,p as S,n as E,v as V,t as I,j as p,d as k,u as x,s as P}from"./index-Bsitvbq3.js";import{p as m}from"./api-C2dT6Vnw.js";import{I as C}from"./ImageUploader-DVGNSmq7.js";const U={class:"edit-post-page"},B={class:"container"},D={key:0,class:"loading-state"},M={key:1,class:"post-form-card"},N={class:"form-layout"},R={class:"form-left"},T={class:"form-group"},$={class:"form-right"},j={class:"form-group"},q={class:"form-actions"},A=["disabled"],z={__name:"EditPostView",setup(F){const v=P(),n=x(),a=b(),r=k(()=>v.params.id),o=p({postId:null,content:"",image:""}),l=p(!1),i=p(!0);async function f(){i.value=!0;try{const e=await m.getPostDetail(r.value);if(e.data.status==="SUCCESS"&&e.data.data){const s=e.data.data.postVo;o.value={postId:s.postId,content:s.content||"",image:s.image||""}}else a.showError(["找不到貼文"]),n.push("/")}catch{a.showError(["載入貼文失敗"]),n.push("/")}finally{i.value=!1}}async function _(){if(!(l.value||!o.value.content.trim())){l.value=!0;try{const e=await m.editPost(o.value);e.data.status==="SUCCESS"?(a.showSuccess(["貼文已更新！"]),n.push(`/post/${r.value}`)):a.showError(e.data.message||["更新失敗"])}catch{a.showError(["更新失敗，請稍後再試"])}finally{l.value=!1}}}function g(){n.push(`/post/${r.value}`)}return y(()=>{f()}),(e,s)=>(u(),c("div",U,[t("div",B,[s[5]||(s[5]=t("div",{class:"page-header-section"},[t("h1",{class:"page-title"},"✏️ 編輯貼文"),t("p",{class:"page-subtitle"},"修改你的貼文內容")],-1)),i.value?(u(),c("div",D,[...s[2]||(s[2]=[t("div",{class:"spinner"},null,-1),t("p",null,"載入中...",-1)])])):(u(),c("div",M,[t("form",{onSubmit:w(_,["prevent"])},[t("div",N,[t("div",R,[t("div",T,[s[3]||(s[3]=t("label",{class:"form-label"},"貼文圖片",-1)),S(C,{modelValue:o.value.image,"onUpdate:modelValue":s[0]||(s[0]=d=>o.value.image=d)},null,8,["modelValue"])])]),t("div",$,[t("div",j,[s[4]||(s[4]=t("label",{class:"form-label"},"貼文內容 *",-1)),E(t("textarea",{"onUpdate:modelValue":s[1]||(s[1]=d=>o.value.content=d),class:"form-input form-textarea",placeholder:"寫下你想分享的內容...",rows:"10",required:""},null,512),[[V,o.value.content]])])])]),t("div",q,[t("button",{type:"button",class:"btn btn-secondary",onClick:g}," 取消 "),t("button",{type:"submit",class:"btn btn-primary",disabled:l.value||!o.value.content.trim()},I(l.value?"更新中...":"更新貼文"),9,A)])],32)]))])]))}},K=h(z,[["__scopeId","data-v-ada2c9ed"]]);export{K as default};
